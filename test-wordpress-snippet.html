<!DOCTYPE html>
<html>
<head>
    <title>–¢–µ—Å—Ç WordPress —Å–Ω–∏–ø–ø–µ—Ç–∞</title>
</head>
<body>
    <!-- –°–∏–º—É–ª—è—Ü–∏—è —Ç–æ–≥–æ, —á—Ç–æ –¥–µ–ª–∞–µ—Ç WordPress —Å–Ω–∏–ø–ø–µ—Ç -->
    <div class="elementor-widget-video" style="width: 800px; height: 450px; background: #333; position: static;">
        <video style="width: 100%; height: 100%;"></video>
    </div>

    <div id="debug"></div>

<script>
// –≠—Ç–æ –∫–æ–¥ –∏–∑ —Å–Ω–∏–ø–ø–µ—Ç–∞ WordPress
document.addEventListener('DOMContentLoaded', function() {
    console.log('–¢–µ—Å—Ç WordPress —Å–Ω–∏–ø–ø–µ—Ç–∞...');
    const debug = document.getElementById('debug');
    
    // 1. –ò—â–µ–º –≤–∏–¥–µ–æ –≤–∏–¥–∂–µ—Ç
    const videoWidget = document.querySelector('.elementor-widget-video');
    
    if (!videoWidget) {
        debug.innerHTML += '‚ùå –í–∏–¥–µ–æ –≤–∏–¥–∂–µ—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω<br>';
        return;
    }
    debug.innerHTML += '‚úÖ –í–∏–¥–µ–æ –≤–∏–¥–∂–µ—Ç –Ω–∞–π–¥–µ–Ω<br>';
    
    // 2. –°–æ–∑–¥–∞–µ–º –∫–Ω–æ–ø–∫—É
    const btn = document.createElement('button');
    btn.innerHTML = 'ü§ñ AI ALLORA';
    btn.style.cssText = `
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: rgba(15,30,90,0.88);
        color: #fff;
        border: none;
        padding: 16px 42px;
        border-radius: 10px;
        font-size: 18px;
        font-weight: 600;
        cursor: pointer;
        z-index: 9999;
    `;
    
    // 3. –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞
    btn.onclick = function(e) {
        e.preventDefault();
        e.stopPropagation();
        
        // –¢–µ—Å—Ç 1: –ü—Ä–æ–±—É–µ–º –æ—Ç–∫—Ä—ã—Ç—å localhost:3000
        debug.innerHTML += 'üîÑ –ü—Ä–æ–±—É—é –æ—Ç–∫—Ä—ã—Ç—å localhost:3000...<br>';
        
        fetch('http://localhost:3000/test')
            .then(response => {
                if (response.ok) {
                    debug.innerHTML += '‚úÖ –°–µ—Ä–≤–µ—Ä –¥–æ—Å—Ç—É–ø–µ–Ω<br>';
                    // –û—Ç–∫—Ä—ã–≤–∞–µ–º iframe
                    openChat();
                } else {
                    debug.innerHTML += '‚ùå –°–µ—Ä–≤–µ—Ä –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç<br>';
                    showError();
                }
            })
            .catch(error => {
                debug.innerHTML += `‚ùå –û—à–∏–±–∫–∞: ${error.message}<br>`;
                showError();
            });
    };
    
    function openChat() {
        const iframe = document.createElement('iframe');
        iframe.src = 'http://localhost:3000';
        iframe.style.cssText = `
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 400px;
            height: 500px;
            border: none;
            border-radius: 15px;
            z-index: 10000;
        `;
        document.body.appendChild(iframe);
        debug.innerHTML += '‚úÖ –ß–∞—Ç –æ—Ç–∫—Ä—ã—Ç<br>';
    }
    
    function showError() {
        alert('–°–µ—Ä–≤–µ—Ä —á–∞—Ç–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω –Ω–∞ localhost:3000');
    }
    
    // –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É
    videoWidget.style.position = 'relative';
    videoWidget.appendChild(btn);
    debug.innerHTML += '‚úÖ –ö–Ω–æ–ø–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞<br>';
});
</script>
</body>
</html>
